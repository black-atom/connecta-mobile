<ion-header>
  <ion-navbar color="primary">
    <ion-title>Detalhes</ion-title>
  </ion-navbar>
</ion-header>


<ion-content>
  <ion-card *ngIf="atendimento$ | async; let atendimento">
    <img src="assets/img/background-chamados.svg" />

    <ion-card-content>
      <ion-card-title class="line">
        <ion-row>
          <ion-col col-10>
              <h2><strong>{{atendimento.cliente.nome_razao_social | uppercase}}</strong></h2>
              <p>{{atendimento.cliente.cnpj_cpf}}</p>
          </ion-col>
          <ion-col col-2>
            <ion-fab top right bottom *ngIf="!atendimento.fim">
                <button ion-fab mini color="accent"><ion-icon name="arrow-dropdown"></ion-icon></button>
                <ion-fab-list side="bottom">
                  <button (click)="mostrarPromptKmInicial(atendimento.km_inicio.km)" ion-fab><i class="fa fa-flag-o" aria-hidden="true"></i></button>
                  <button [disabled]="!atendimento.km_inicio.km" (click)="mostrarPromptKmFinal(atendimento.km_final.km)" ion-fab><i class="fa fa-flag-checkered" aria-hidden="true"></i></button>
                  <button ion-fab  [disabled]="!atendimento.km_inicio.km || !atendimento.km_final.km || atendimento.inicio" [ngClass]="{'indica_inicio': atendimento.inicio !== null}"  (click)="mostrarConfirmacaoInicioAtendimento()" ><ion-icon color="accent" name="play"></ion-icon></button>
                  <button ion-fab (click)="mostrarOpcoesParaTirarFoto()"><i class="fa fa-camera" aria-hidden="true"></i></button>
                  <button ion-fab (click)="mostrarModalInteracaoDados()"><ion-icon color="accent" name="md-list-box"></ion-icon></button>
                  <button ion-fab [disabled]="!atendimento.inicio" (click)="mostrarConfirmacaoFimAtendimento()"><ion-icon color="accent" name="trophy"></ion-icon></button>
                </ion-fab-list>
              </ion-fab>
          </ion-col>
        </ion-row>

      </ion-card-title>

      <ion-list no-lines>

          <ion-item *ngIf="atendimento.inicio !== null || undefined" >
              <ion-icon color="primary" name="checkmark" item-start></ion-icon>
               <h2>Status do chamado</h2>
               <p> Iniciado às {{atendimento.inicio | date: 'hh:mm'}}</p>
               <p *ngIf="atendimento.fim !== null || undefined" > Finalizado às {{atendimento.fim | date: 'hh:mm'}}</p>
           </ion-item>


        <ion-item>
          <ion-icon color="primary" name="person" item-start></ion-icon>
           <h2>Contato</h2>
           <p>{{ atendimento.contato.nome }}</p>
           <p>{{ atendimento.contato.telefone }}</p>
       </ion-item>

       <ion-item text-wrap class="address" (click)="openGPS(atendimento.endereco)">
          <ion-icon color="primary" name="pin" item-start></ion-icon>
          <h2>Localização</h2>
          <p>
            {{ atendimento.endereco.rua + ',' + ' '
              + atendimento.endereco.numero }} </p>

          <p>{{atendimento.endereco.bairro + ',' + ' '
              + atendimento.endereco.cidade}}</p>

          <p>{{atendimento.endereco.uf + ',' + ' ' + atendimento.endereco.cep}}</p>

          <p><i>{{ atendimento.endereco.ponto_referencia }}</i></p>
       </ion-item>

       <ion-item class="line" >
          <ion-icon color="primary" name="car" item-start></ion-icon>
          <h2>Estacionamento</h2>
          <p>{{atendimento.estacionamento}}</p>
       </ion-item>


       <ion-item>
          <ion-icon color="primary" name="information-circle" item-start></ion-icon>
          <h2>Tipo de serviço</h2>
          <p>{{atendimento.tipo}}</p>
       </ion-item>

       <ion-item text-wrap>
          <ion-icon color="primary" name="information-circle" item-start></ion-icon>
          <h2>Modelo do equipamento</h2>
          <p>{{atendimento.modelo_equipamento}}</p>
       </ion-item>

       <ion-item text-wrap>
          <ion-icon color="primary" name="information-circle" item-start></ion-icon>
          <h2>Descrição do chamado</h2>
          <p>{{atendimento.descricao}}</p>
       </ion-item>

       <ion-item text-wrap>
          <ion-icon color="primary" name="information-circle" item-start></ion-icon>
          <h2>Testes efetuados</h2>
          <p>{{atendimento.testes_efetuados}}</p>
       </ion-item>

      </ion-list>
    </ion-card-content>

  </ion-card>


</ion-content>
